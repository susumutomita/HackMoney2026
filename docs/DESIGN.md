# ZeroKey Treasury - 設計書

## プロダクト概要

**ZeroKey Treasury** は、AIエージェントがAPIサービスを自律的に利用・決済する際の「実行ファイアウォール」です。

### コンセプト: AI Agent API Marketplace with Execution Firewall

```
┌─────────────────────────────────────────────────────────────────────────┐
│                    AI Agent API Marketplace                             │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────┐      A2A交渉        ┌──────────────┐                 │
│  │  Client AI   │ ←─────────────────→ │ Provider AI  │                 │
│  │  (利用者)    │   価格・条件調整     │ (サービス)   │                 │
│  └──────┬───────┘                     └──────────────┘                 │
│         │                                                               │
│         │ 交渉成立 → 支払い実行要求                                     │
│         ▼                                                               │
│  ┌──────────────────────────────────────────────────────────────┐      │
│  │              ZeroKey Execution Firewall                      │      │
│  │  • トランザクション意図のセマンティック分析 (LLM)            │      │
│  │  • ポリシー適合チェック（予算、ホワイトリスト、レート制限）  │      │
│  │  • 詐欺・異常パターン検出                                    │      │
│  └──────┬───────────────────────────────────────────────────────┘      │
│         │ APPROVED / REJECTED                                           │
│         ▼                                                               │
│  ┌──────────────────────────────────────────────────────────────┐      │
│  │              x402 Payment + On-chain Guard                   │      │
│  │  • HTTP 402 Payment Required プロトコル                      │      │
│  │  • USDC/ステーブルコイン決済                                 │      │
│  │  • オンチェーン承認記録 (ZeroKeyGuard.sol)                   │      │
│  └──────────────────────────────────────────────────────────────┘      │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## ターゲットプライズ (HackMoney 2026)

| スポンサー             | 賞金    | 適合度 | 技術要件                         |
| ---------------------- | ------- | ------ | -------------------------------- |
| **Circle**             | $10,000 | ◎      | USDC決済、Circle Developer Tools |
| **Yellow**             | $15,000 | ○      | State Channels、ERC-7824         |
| **Uniswap Foundation** | $10,000 | △      | Unichain、Uniswap v4             |
| **LI.FI**              | $6,000  | ○      | クロスチェーンブリッジ・DEX      |
| **ENS**                | $5,000  | △      | ENS統合                          |

### 主要ターゲット: Circle ($10,000)

- **USDC** をAIエージェント間決済の基軸通貨に
- **Circle Web3 Services** (Programmable Wallets等) を活用
- x402プロトコルとの親和性が高い

---

## ユースケース: AI秘書がAPIサービスを利用

### シナリオ

```
[企業のAI秘書] 「この契約書を英語に翻訳して」
        │
        ▼ A2A Discovery & Negotiation
[翻訳サービスA] 「$0.05/1000トークン」
[翻訳サービスB] 「$0.03/1000トークン」
[翻訳サービスC] 「$0.01/1000トークン」← 怪しい新規プロバイダ
        │
        ▼ 交渉結果: サービスB選択 ($0.03)
        │
        ▼ ZeroKey Firewall
    ┌────────────────────────────────────────┐
    │ LLM分析結果:                           │
    │ • 目的: 業務文書翻訳 ✅               │
    │ • 金額: $0.03 (予算内) ✅             │
    │ • プロバイダ: 信頼スコア 85/100 ✅    │
    │ • リスク: LOW                          │
    │ → APPROVED                             │
    └────────────────────────────────────────┘
        │
        ▼ x402 Payment
    HTTP 402 → Payment Proof → API Response
```

### Firewallがブロックするケース

1. **予算超過**: 日次上限$100を超える利用
2. **不審なプロバイダ**: 新規 + 極端に安い = 詐欺リスク
3. **業務外利用**: ゲーム翻訳、個人用途など
4. **異常パターン**: 短時間に大量リクエスト

---

## 次のファイル: ARCHITECTURE.md
